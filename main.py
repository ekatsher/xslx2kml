# coding=utf-8
# This is a sample Python script.
# test comment
# Press ⌃R to execute it or replace it with your code.
# Press Double ⇧ to search everywhere for classes, files, tool windows, actions, and settings.
# from StdSuites import null

import sys
import random

import openpyxl
from openpyxl import load_workbook
from lxml import etree
from pykml.factory import KML_ElementMaker as KML
from pykml.util import to_wkt_list
import configparser

import shapely.geometry
import shapely.wkt
from shapely.geometry import Point, Polygon, MultiPolygon, mapping


def cleanPointCoords(coordinates):
    try:
        return str(mapping(coordinates)['coordinates']).replace('(', '').replace(')', '')
    except Exception as e:
        print 'Point must have a geotext format in the input file'
        sys.exit(1)


def coordsToKMLStyle(coordinate):
    return str(coordinate).replace('(', '').replace(')', '') + ' '


def multiGeometryToArrayPolygonsKML(multyGeometryArray):
    kml_polys_to_multygeometry = []
    for shape in multyGeometryArray:
        map_shape = mapping(shape)
        coordinates_shape = map_shape['coordinates']
        poly = KML.Polygon()
        outer = KML.outerBoundaryIs()
        coordinatest_kml = str(coordinates_shape[0]).replace('((', '').replace('))', '').replace('), (', ' ')
        coordinatest_kml = coordinatest_kml.strip()
        outer.append(KML.LinearRing(
            KML.coordinates(coordinatest_kml)
        ))
        poly.append(outer)
        kml_polys_to_multygeometry.append(poly)
    return kml_polys_to_multygeometry


def multiGeometryToArrayLineStringsKML(multiLineStringsArray):
    kml_lines_to_multygeometry = []
    for shape in multiLineStringsArray:
        map_shape = mapping(shape)
        coordinates_shape = map_shape['coordinates']
        coordinatest_kml = str(coordinates_shape).replace('((', '').replace('))', '').replace('), (', ' ')
        coordinatest_kml = coordinatest_kml.strip()
        line = KML.LineString(KML.coordinates(coordinatest_kml))
        kml_lines_to_multygeometry.append(line)
    return kml_lines_to_multygeometry


def generateRandomColor():
    color = ''
    for i in range(6):
        color += random.choice('0123456789ABCDEF')
    return color


# в исходном файле в колонке 8 (считая с 0) - координаты точек, в колонке 9 - координаты полигонов

# создаём объект парсера конфига
config = configparser.ConfigParser()
# читаем конфиг
config.read("settings.ini")
inputFilePath = config["settings"]["inputFilePath"]
outputFilePath = config["settings"]["outputFilePath"]
startRow = int(config["settings"]["firstRowWithData"])
columnWithGeometry = int(config["settings"]["columnWithGeometry"])
columnWithPointCoords = int(config["settings"]["columnWithPointCoords"])
columnWithName = int(config["settings"]["columnWithName"])
columnWithDescription = int(config["settings"]["columnWithName"])

# читаем файл
book = load_workbook(inputFilePath)
sheet = book.active

# create a KML file skeleton
doc = KML.kml(
    KML.Document()
)


for row in range(startRow, sheet.max_row + 1):

    # возьмем координаты геометрии из файла
    new_poly_coord = str(sheet[row][columnWithGeometry].value)
    # возьмем координату точки из файла
    pointText = str(sheet[row][columnWithPointCoords].value)

    # возьмем геометрию из файла
    # примеры геометрий в формате geotext
    # geometryText = 'MULTIPOLYGON(((32.0513057 49.0240471,32.0552591 49.022771,32.0560506 49.0229806,32.0560623 49.0232187,32.0561136 49.0234524,32.0563567 49.0245643,32.0566027 49.0256453,32.056937 49.0270502,32.0575775 49.0301217,32.0553281 49.0306668,32.0544182 49.0295614,32.054927 49.0294927,32.0547026 49.0288059,32.054119 49.0288648,32.0529667 49.0290905,32.0513057 49.0240471)),((32.0572778 49.0533803,32.0576792 49.0530304,32.0580573 49.0528139,32.0584595 49.0523337,32.0593676 49.0519216,32.0600575 49.0516003,32.0606371 49.0512497,32.0614401 49.0506492,32.0622527 49.0500673,32.06262 49.0496478,32.062227 49.0488962,32.0611568 49.048768,32.0596713 49.0480229,32.0588411 49.0474759,32.0587208 49.0470759,32.0591646 49.0470246,32.059768 49.0468144,32.0605735 49.0462856,32.061349 49.0458941,32.0620322 49.0457241,32.0625657 49.0456326,32.063192 49.0454487,32.0636986 49.0452451,32.0640278 49.0450612,32.0642673 49.0448184,32.0645459 49.0442764,32.064801 49.0433503,32.0651758 49.0424243,32.0654628 49.0419781,32.0658695 49.0414633,32.0662938 49.0411039,32.0667401 49.0406088,32.0670666 49.0403099,32.0675965 49.0401532,32.0683957 49.0400553,32.0688266 49.0394017,32.069994 49.036583,32.0692414 49.0347001,32.0669831 49.0320802,32.0646803 49.0295751,32.0666035 49.029613,32.0702704 49.0294969,32.0726924 49.0313891,32.0747569 49.0331584,32.0750594 49.0334176,32.0766733 49.0330762,32.0763119 49.0291931,32.0763717 49.0288372,32.0764866 49.0287157,32.0766354 49.0285585,32.0775516 49.0287968,32.07757 49.0286473,32.0776357 49.028113,32.0779547 49.0275339,32.0782925 49.0269205,32.0786499 49.0262716,32.0791067 49.0254421,32.0792018 49.025291,32.0797684 49.0243909,32.0807572 49.0228203,32.080989 49.0225527,32.0812263 49.0222788,32.0815567 49.0217741,32.0816673 49.0214371,32.0820306 49.0214177,32.0819123 49.0207696,32.0818312 49.0203248,32.0817227 49.0197304,32.0817014 49.0197081,32.0851728 49.0195489,32.0844782 49.0157908,32.0853685 49.0160063,32.0862613 49.0162224,32.0864943 49.0162788,32.0863737 49.0159094,32.0865762 49.0152575,32.0866153 49.0151318,32.0871258 49.0155036,32.0881 49.016128,32.0885049 49.0164742,32.0890726 49.0173125,32.0891793 49.0173026,32.0901765 49.0169062,32.0903378 49.0168969,32.0904575 49.0171137,32.0905521 49.0173482,32.0906479 49.0179546,32.0908432 49.0178775,32.0917924 49.0175029,32.0947741 49.0162839,32.0952184 49.0161023,32.095414 49.0160224,32.0932246 49.0132107,32.0929262 49.0128186,32.0931076 49.012754,32.0941808 49.0124056,32.0941556 49.0119671,32.0943833 49.0118818,32.0950011 49.0119814,32.0975544 49.0110498,32.0979411 49.0113794,32.0983041 49.0113947,32.1006222 49.0105371,32.1022285 49.0127746,32.1036036 49.0146008,32.104228 49.0154301,32.104389 49.0155392,32.104686 49.0156684,32.1082414 49.01645,32.1088802 49.0165908,32.1096142 49.0167525,32.1138447 49.0088116,32.1186818 49.0156263,32.1219499 49.0202796,32.1274511 49.0171838,32.1301111 49.0158278,32.1310083 49.0153285,32.1313563 49.0150974,32.131626 49.0148633,32.1317742 49.0145483,32.1317697 49.0143146,32.1317292 49.0141547,32.1327908 49.015057,32.1334261 49.015523,32.1340381 49.0171279,32.1346567 49.0170269,32.1345532 49.0161231,32.1357836 49.0159289,32.1363374 49.0158786,32.1364788 49.016031,32.1364696 49.0161334,32.1367239 49.0163267,32.1375769 49.0165563,32.1381637 49.0165219,32.1387402 49.0167065,32.1401197 49.0170884,32.1425923 49.0180115,32.1429955 49.0183255,32.1432888 49.0187447,32.1425773 49.0193532,32.1424907 49.019683,32.1445152 49.0205829,32.1428131 49.0215772,32.1428644 49.0238007,32.1429551 49.0243142,32.1428186 49.0256089,32.1432108 49.0258493,32.1432834 49.026696,32.1418909 49.0275154,32.1410617 49.0279151,32.1369409 49.0299641,32.135811 49.030502,32.13513 49.0307883,32.1346012 49.0309471,32.1341097 49.0310737,32.1310196 49.0338562,32.1299933 49.0349085,32.1292443 49.0356976,32.1296326 49.0358721,32.1288392 49.0364319,32.1281014 49.0368033,32.127228 49.0371091,32.1264964 49.0373003,32.1270197 49.0384148,32.118033 49.0418412,32.1172304 49.0422052,32.1169674 49.042352,32.1167937 49.0429175,32.1163868 49.0455689,32.1195049 49.0485827,32.1204094 49.0473015,32.1208143 49.0468558,32.1214855 49.0465723,32.1220294 49.046518,32.1243331 49.046651,32.1254647 49.0471058,32.1265962 49.0476261,32.1269165 49.0484858,32.1272451 49.0489796,32.1272042 49.0492869,32.127408 49.04941,32.1279285 49.0494676,32.127803 49.0500633,32.1262525 49.0501625,32.125327 49.0507403,32.1242682 49.0512743,32.1231277 49.0516828,32.1209001 49.0526446,32.1197914 49.0530704,32.1200949 49.0530977,32.1206382 49.0530159,32.1210195 49.0531087,32.1225524 49.0530104,32.1237573 49.0534229,32.124354 49.0535882,32.1252645 49.0539671,32.1260646 49.0543326,32.1266204 49.0544863,32.1292122 49.0557827,32.1307215 49.0563795,32.1316872 49.0567273,32.1324691 49.0568384,32.1338862 49.0572273,32.1338513 49.0575199,32.1329347 49.0574599,32.1322397 49.0574817,32.1322719 49.0572906,32.1314504 49.0572688,32.1312386 49.0573398,32.1311289 49.0579815,32.1304743 49.0582477,32.1300029 49.0590107,32.1263248 49.0570969,32.1260343 49.0573408,32.1220891 49.0606528,32.1217403 49.0609456,32.1205894 49.060859,32.113315 49.0615503,32.1119481 49.0616588,32.1109874 49.0616108,32.1091322 49.0617922,32.1085698 49.0613163,32.1082362 49.0610114,32.1079778 49.0606643,32.109697 49.0528951,32.1092759 49.0515084,32.1003284 49.0564358,32.0882023 49.0603672,32.0822437 49.0611899,32.0815917 49.0628127,32.081563 49.0633105,32.081254 49.0626505,32.0808431 49.062643,32.0810675 49.0604346,32.0810047 49.0595244,32.0736244 49.0604026,32.0714164 49.0512749,32.071338 49.050888,32.067432 49.05215,32.0672598 49.0523202,32.067462 49.053443,32.0646938 49.0538713,32.0640796 49.0528215,32.0608492 49.0537777,32.0581208 49.0545959,32.0577398 49.0540306,32.0583051 49.0535098,32.0572778 49.0533803)),((32.0581293 49.0290021,32.0589673 49.0289433,32.0593214 49.0297101,32.0585427 49.0298928,32.0581293 49.0290021)),((32.0582055 49.0056843,32.0583767 49.004371,32.0586302 49.0024269,32.0603154 49.0034952,32.063648 49.0037617,32.0680405 49.0039041,32.0709533 49.0038453,32.0731833 49.0042302,32.0738934 49.0047632,32.074906 49.006121,32.0755936 49.0074806,32.0757732 49.007461,32.0768907 49.0078654,32.0775988 49.0083051,32.0773743 49.008472,32.0774491 49.0090806,32.0778253 49.0096006,32.0782039 49.0096937,32.078054 49.0097504,32.0777905 49.0098636,32.0773499 49.0100215,32.0769865 49.0100781,32.0764914 49.0101228,32.0760455 49.01014,32.0756924 49.0100931,32.0744881 49.0104401,32.0740374 49.0099345,32.0735854 49.0096001,32.0734234 49.009242,32.0724806 49.0079486,32.0718891 49.0070957,32.0712975 49.0067724,32.0705581 49.0063883,32.0698309 49.0060003,32.0694797 49.0059316,32.0674709 49.0059397,32.0655544 49.0058992,32.0630711 49.0058548,32.0625473 49.0058386,32.0620051 49.0059154,32.0614382 49.0059922,32.0611609 49.0058992,32.0607418 49.0056405,32.0604091 49.0055516,32.059836 49.0055274,32.0591705 49.0056001,32.0589151 49.005669,32.0584165 49.0058432,32.0582055 49.0056843)),((32.0583837 49.0262254,32.060329 49.0260194,32.0603739 49.0262156,32.0615273 49.0259832,32.0615358 49.0267142,32.0616835 49.0275735,32.0617298 49.0276579,32.0628467 49.0275338,32.0631471 49.0281005,32.0643933 49.0294717,32.0627681 49.0299539,32.0620349 49.0293554,32.0615112 49.0287863,32.0609874 49.0289335,32.0606133 49.0285214,32.0592067 49.0282368,32.0583837 49.0271772,32.058683 49.0269221,32.0583837 49.0262254)))'
    # geometryText = 'POLYGON((73.0663776 51.1285222,73.0865049 51.1203609,73.1104517 51.1294379,73.0998516 51.1396979,73.0860757 51.1417173,73.0663776 51.1285222))'
    # geometryText = 'MULTIPOLYGON(((76.7382775 43.314451,76.7387238 43.313583,76.7395325 43.3129419,76.7398432 43.3125621,76.7399881 43.3116878,76.739441 43.3107322,76.7463632 43.306225,76.7482164 43.3030906,76.7504068 43.3031982,76.75456 43.3042791,76.7546778 43.303912,76.752126 43.3031551,76.7540427 43.2970521,76.7541211 43.2969491,76.754999 43.2970377,76.7585028 43.2960081,76.7592851 43.2958147,76.7594987 43.2954595,76.7631672 43.2944401,76.7632419 43.2946195,76.7720166 43.2919902,76.7800848 43.2893897,76.7804127 43.2893815,76.7811015 43.2891773,76.7812411 43.2889226,76.7820424 43.288636,76.7816299 43.2880662,76.7840836 43.2873031,76.782639 43.286664,76.7833701 43.284963,76.7844996 43.2837309,76.7848836 43.2838973,76.785082 43.2818605,76.7853217 43.2816019,76.7909791 43.2840329,76.7908146 43.2848087,76.7896059 43.2852605,76.7903329 43.2857576,76.7904744 43.2860128,76.7902264 43.2864821,76.7917689 43.2885629,76.7923949 43.2884507,76.7926566 43.2879673,76.7928244 43.2878422,76.7950412 43.2873534,76.7961863 43.286851,76.7969182 43.285531,76.7968988 43.2846751,76.7969366 43.283961,76.7970218 43.2835161,76.7972044 43.2831024,76.7973433 43.282934,76.7977199 43.2825789,76.7980836 43.282452,76.798139 43.2819562,76.7996436 43.2743576,76.7978515 43.2721599,76.7974451 43.2719802,76.7974806 43.2717998,76.7971445 43.2716414,76.7886464 43.2676364,76.7874497 43.2670724,76.7870634 43.2668004,76.786931 43.2667072,76.7864792 43.26621,76.7864276 43.2661532,76.7867985 43.2658781,76.7919203 43.2608834,76.7921616 43.2607517,76.7896914 43.2596459,76.7898422 43.2595565,76.7895075 43.2593718,76.7894403 43.2594456,76.7893801 43.2594333,76.7884969 43.2561328,76.7884169 43.2560361,76.7884264 43.2558641,76.7885651 43.25568,76.7924504 43.2532851,76.7928124 43.252944,76.7930393 43.2526747,76.7931958 43.2519621,76.7931395 43.2508555,76.7934368 43.2503969,76.7926817 43.2500631,76.7914271 43.2525117,76.790598 43.2521632,76.7888004 43.2532617,76.7883092 43.2528407,76.7873485 43.2527318,76.7871048 43.2528705,76.7857502 43.2516221,76.7858399 43.2513722,76.784135 43.2509782,76.7838792 43.2515855,76.7836264 43.2515478,76.7832416 43.2514644,76.7829853 43.2521377,76.7817333 43.2516896,76.7815066 43.251715,76.7757647 43.249541,76.7791 43.2453488,76.777648 43.2448155,76.7803905 43.240626,76.780476 43.2404953,76.780607 43.2402952,76.7853845 43.232996,76.7858842 43.2322325,76.778703 43.2314901,76.7752557 43.231091,76.7719186 43.2307417,76.7706986 43.230581,76.7695545 43.2303662,76.7699254 43.2288798,76.7715806 43.2265124,76.7720843 43.2254149,76.772798 43.2229184,76.7725574 43.2214849,76.7788108 43.2225258,76.7806354 43.2182002,76.7787524 43.2180819,76.7718805 43.2180343,76.7718676 43.2151399,76.7755981 43.2076998,76.7769387 43.2043258,76.7773713 43.2025245,76.7786183 43.1997163,76.7799918 43.1978973,76.7809873 43.1987057,76.7808201 43.1994911,76.7801472 43.1996117,76.7800341 43.2004214,76.7808035 43.2009562,76.7808124 43.2015244,76.782179 43.2016453,76.7827022 43.1998565,76.7843898 43.1982024,76.7843088 43.1964735,76.7847638 43.196144,76.7865987 43.1971373,76.7890889 43.1972744,76.7898508 43.196456,76.7904664 43.192849,76.7912774 43.1900482,76.790534 43.1887376,76.7904936 43.1885212,76.7912161 43.1864995,76.7901769 43.1862957,76.7917347 43.182176,76.7917933 43.1794373,76.7916351 43.1783961,76.7926141 43.175301,76.7897623 43.1749932,76.7911037 43.1720928,76.7924328 43.1697825,76.7930864 43.1677991,76.7931698 43.1673963,76.7927482 43.1673354,76.7927361 43.1672891,76.7894596 43.1672552,76.7896879 43.1668715,76.7893475 43.166727,76.7893786 43.1666896,76.7890581 43.1665561,76.7887885 43.1666856,76.7856747 43.1653186,76.7872165 43.1645277,76.787294 43.1638116,76.7879652 43.1633309,76.7888391 43.1629442,76.7882184 43.1624631,76.7875074 43.1627339,76.7861129 43.1626422,76.782011 43.1616474,76.7796198 43.1615921,76.7794602 43.1612921,76.7772669 43.160138,76.7768437 43.1600146,76.7765557 43.1596599,76.7765437 43.1593275,76.7771274 43.159113,76.777456 43.1587669,76.778182 43.1585459,76.7797152 43.1584347,76.7813524 43.15778,76.7891685 43.1573496,76.7920245 43.1569064,76.7925453 43.1574197,76.7937663 43.1575454,76.7951311 43.1568299,76.796898 43.1552935,76.7975018 43.1542199,76.7980933 43.1546415,76.7986612 43.1537387,76.7988089 43.1525551,76.7986031 43.1517615,76.7987489 43.1502661,76.7985702 43.1490129,76.7987812 43.1481952,76.7991753 43.1474434,76.7995769 43.1463668,76.8029226 43.1458246,76.8055603 43.1459518,76.8077466 43.1472017,76.8084227 43.1465653,76.80874 43.144536,76.808654 43.1420809,76.8087728 43.1407079,76.8081628 43.1385265,76.8078724 43.1365874,76.8080701 43.1357373,76.8236241 43.1364115,76.8356839 43.1338905,76.8340224 43.1327019,76.8332018 43.1311339,76.8330133 43.1301343,76.8330957 43.1284821,76.8327893 43.1240831,76.8342411 43.123173,76.836697 43.1240912,76.838279 43.124101,76.840855 43.1244561,76.8426967 43.1252712,76.8424657 43.1239884,76.8432548 43.1214774,76.8483707 43.1228898,76.8498297 43.122318,76.8503102 43.122549,76.8511973 43.1234651,76.8514743 43.1257573,76.8514347 43.1276443,76.8535852 43.1299215,76.8526953 43.1321138,76.852859 43.134832,76.8549074 43.1345408,76.8550475 43.1334349,76.8558842 43.1317174,76.8575507 43.1333148,76.8591442 43.1330858,76.8589919 43.1315775,76.8604497 43.1321151,76.8614419 43.1307653,76.8627503 43.1304785,76.8637461 43.1312549,76.864186 43.1326156,76.8655097 43.1326253,76.8668327 43.1313715,76.8704702 43.1266733,76.8743783 43.1260303,76.8747737 43.1262339,76.8755877 43.1271182,76.8899587 43.1272202,76.8951548 43.1260948,76.8944074 43.1214783,76.896594 43.1193749,76.8988626 43.1136098,76.8993313 43.109282,76.8994205 43.1084581,76.8988521 43.1020953,76.8989012 43.1017182,76.8998726 43.0942597,76.900372 43.0867241,76.9006974 43.0839472,76.902194 43.082228,76.9053525 43.0801478,76.9090024 43.0797805,76.915694 43.0811791,76.9202599 43.0825972,76.9307989 43.0851442,76.9370259 43.0850356,76.9455012 43.0842715,76.9566014 43.0820632,76.9623529 43.0778112,76.9665803 43.0736767,76.9676087 43.0692645,76.966699 43.0650833,76.9636389 43.0604595,76.963719 43.0592343,76.9620751 43.0573497,76.9577923 43.0540309,76.9571707 43.0530159,76.950575 43.0499943,76.9472385 43.04803,76.9432037 43.0488393,76.94227 43.0468023,76.9394871 43.0462531,76.9367805 43.0443288,76.9368855 43.0409043,76.9389229 43.0395974,76.9415377 43.0387006,76.9434791 43.0337707,76.9448202 43.0337942,76.9496133 43.0395352,76.9578678 43.0434188,76.963503 43.0468516,76.966515 43.0496182,76.9724144 43.0473353,76.9798923 43.0445928,76.9830304 43.0440355,76.9834174 43.0438252,76.9842245 43.0435817,76.9854746 43.0433658,76.9862149 43.0432991,76.9877484 43.0436089,76.9888848 43.0444337,76.9894217 43.0445681,76.9904268 43.0444645,76.9919709 43.0447809,76.9931102 43.0455871,76.9934936 43.0466479,76.9938034 43.0473392,77.0299106 43.0431435,77.0324279 43.038161,77.0569448 43.0328438,77.0771844 43.0340662,77.089632 43.0709378,77.0830789 43.091364,77.0800349 43.1011416,77.0799246 43.1149821,77.0800909 43.1153912,77.0806368 43.1152806,77.0815168 43.1152591,77.083657 43.1159693,77.0855888 43.116376,77.0864447 43.1164896,77.0872858 43.1164914,77.0884796 43.1160882,77.0901602 43.1124099,77.0917851 43.1121189,77.0982087 43.1152142,77.1002414 43.1141453,77.1018392 43.1124223,77.1097496 43.1128476,77.1094502 43.1105288,77.1109472 43.1103209,77.1137245 43.109935,77.1136014 43.1130186,77.1210171 43.1170026,77.1212102 43.1171661,77.1212456 43.1174324,77.1211931 43.1175895,77.1209677 43.1177131,77.1206413 43.1177324,77.1202972 43.1176595,77.1132327 43.1138609,77.1125603 43.1159031,77.1104941 43.1164937,77.1073765 43.1176562,77.0971696 43.1242839,77.0923345 43.1279993,77.0916269 43.1273565,77.0907568 43.1272475,77.0895604 43.1275131,77.0879434 43.1276377,77.0867287 43.1286452,77.0846317 43.129646,77.0826333 43.1303387,77.0790786 43.132156,77.0783434 43.1327655,77.0780455 43.1336999,77.0781876 43.1344956,77.0769217 43.1358748,77.0762169 43.1370596,77.0759393 43.1378717,77.0755075 43.1382112,77.0720894 43.1391255,77.0712457 43.1389168,77.0686308 43.1407745,77.068933 43.1410869,77.068072 43.1415374,77.0669719 43.1426315,77.0660841 43.144023,77.0649711 43.1441356,77.0637321 43.1444048,77.0629371 43.1449111,77.0667539 43.1514115,77.064457 43.1536067,77.0651548 43.1535382,77.0652589 43.1539818,77.0644968 43.1540549,77.0617914 43.1571336,77.0602256 43.1600524,77.0631983 43.1604211,77.0673541 43.1622008,77.068404 43.1631449,77.0687867 43.1641116,77.0697813 43.1650224,77.070097 43.1650994,77.071368 43.1648426,77.0727574 43.1639303,77.0755612 43.1630292,77.0760542 43.1629736,77.0765193 43.1628914,77.0766807 43.1627169,77.0773353 43.1623747,77.077701 43.1621983,77.0782759 43.1618073,77.0789893 43.1614601,77.0793681 43.1612312,77.0799103 43.1605971,77.0800879 43.1601129,77.0806301 43.1595401,77.0819776 43.1590734,77.0823317 43.1590137,77.0828308 43.1588657,77.0831085 43.1588228,77.0835365 43.1587842,77.0839862 43.1588377,77.0844349 43.1587627,77.0848275 43.1586672,77.0850253 43.1586975,77.0854179 43.1587895,77.0856142 43.15896,77.08589 43.1590691,77.0860162 43.1592157,77.0861892 43.1593146,77.0863621 43.1594714,77.0865397 43.1595976,77.0865771 43.1597306,77.0866239 43.1597476,77.0866682 43.1597897,77.0867757 43.1598937,77.0869673 43.1600744,77.0871286 43.160238,77.0873366 43.1602943,77.0877152 43.1603471,77.0880284 43.1605483,77.0881312 43.1607767,77.0883042 43.1608313,77.0887809 43.1608108,77.0892811 43.1606472,77.089655 43.1606676,77.0901318 43.1607665,77.0904917 43.1607392,77.090903 43.1605517,77.0913751 43.1604392,77.0918846 43.1604392,77.0923099 43.160504,77.0928241 43.1605688,77.093198 43.1604733,77.0936047 43.1602551,77.0941609 43.1600403,77.094619 43.1599141,77.0950817 43.1596789,77.0952245 43.1593214,77.0954593 43.1591189,77.0957345 43.1589792,77.0960802 43.1588307,77.096649 43.1586008,77.0970865 43.158485,77.0975743 43.1583656,77.0978883 43.15821,77.0986394 43.1579645,77.0993299 43.1578465,77.0996458 43.1578773,77.0998184 43.1580356,77.1000498 43.1580519,77.1003921 43.1579742,77.100683 43.1579519,77.1013712 43.1575239,77.1016786 43.1572435,77.1023243 43.1569752,77.10279 43.1567192,77.1031834 43.1565345,77.1034204 43.1564148,77.1038579 43.1559595,77.1043631 43.1555788,77.104969 43.1551601,77.1057192 43.1549305,77.1061438 43.1546775,77.1067057 43.1543993,77.1069088 43.1541798,77.1069265 43.1539301,77.1073909 43.1532758,77.1078842 43.1526599,77.1085122 43.1523688,77.1089248 43.152019,77.109369 43.1510144,77.1170726 43.1516426,77.1168062 43.1536357,77.1192473 43.1570872,77.1209829 43.1579973,77.1222172 43.1668396,77.1282827 43.1689843,77.134891 43.1665374,77.1470137 43.1781582,77.1454858 43.1878562,77.1459644 43.1896483,77.1450774 43.1909743,77.1442338 43.1910336,77.1382218 43.1980925,77.1243845 43.2010009,77.1196546 43.2040738,77.1184212 43.2030034,77.1158306 43.201878,77.1142764 43.2015142,77.1133787 43.1992613,77.1138726 43.1896965,77.1144091 43.1893158,77.1148204 43.1838676,77.1139755 43.1815912,77.1130189 43.1804039,77.1116059 43.1801287,77.1106986 43.1791728,77.1087637 43.1782164,77.1066222 43.1776373,77.1054414 43.1756601,77.1045222 43.1753027,77.1033505 43.1751848,77.1028094 43.1751876,77.0986077 43.1760535,77.0968506 43.183981,77.0717578 43.1945221,77.0688096 43.1969272,77.0591228 43.2167728,77.0535933 43.2239602,77.0532475 43.2250926,77.052232 43.2258831,77.0523213 43.2264878,77.0519693 43.2266099,77.0515254 43.2263024,77.0512088 43.2262892,77.0506298 43.2262652,77.0496371 43.2268122,77.0495486 43.2277384,77.0475391 43.2301772,77.0465439 43.2300127,77.0450073 43.231169,77.0420975 43.2356187,77.0412604 43.2350535,77.0403506 43.2347015,77.0397686 43.2340511,77.0394401 43.2340676,77.0388698 43.2348936,77.0391155 43.2350844,77.0396573 43.2372351,77.0370677 43.2398759,77.0355888 43.2410548,77.0353237 43.2415503,77.0357666 43.2423987,77.0363378 43.2428283,77.0358458 43.2440382,77.035077 43.244059,77.0342269 43.2439512,77.0338226 43.2440201,77.0334859 43.2446684,77.033273 43.2454892,77.0330707 43.2459736,77.0323637 43.2461847,77.0320673 43.2485961,77.0303538 43.2476563,77.0291305 43.2493811,77.028743 43.2495764,77.0267899 43.2491167,77.025998 43.249589,77.0256427 43.2496812,77.0249687 43.2506286,77.0245188 43.251117,77.0240963 43.2513953,77.0237358 43.2514476,77.0167799 43.2596142,77.016396 43.2595606,77.0156654 43.2600299,77.0152275 43.2599611,77.0146581 43.2596831,77.0141233 43.2595689,77.0130069 43.2599705,77.0124106 43.2604731,77.0120549 43.2604365,77.01079 43.2605494,77.0103163 43.2607015,77.0098815 43.2610503,77.0095153 43.2615361,77.0090937 43.2618406,77.0087514 43.2618896,77.00564 43.2620424,77.0046465 43.2626869,77.0051396 43.2627804,77.0065403 43.2646806,77.0065792 43.2650245,77.0064044 43.2665562,77.007028 43.266555,77.0092966 43.2657257,77.0097441 43.2656704,77.0101163 43.2654875,77.0105445 43.2654336,77.011422 43.2650916,77.0121654 43.2650629,77.0127381 43.2649228,77.0135762 43.2648732,77.0139788 43.2654621,77.0144797 43.2661057,77.014948 43.2664051,77.0145441 43.2670366,77.0144036 43.2680388,77.0140687 43.2690453,77.0135816 43.2698346,77.0143289 43.2732291,77.0137914 43.274473,77.0135154 43.2762208,77.0135592 43.2768967,77.0136663 43.2775112,77.0128903 43.2784253,77.0127424 43.2790767,77.0124862 43.2793512,77.0121204 43.2804691,77.0146462 43.2819765,77.0141796 43.2822326,77.0142629 43.282863,77.0138923 43.2836488,77.0114746 43.2829599,77.0113611 43.2836005,77.0112811 43.2840824,77.0112276 43.2843597,77.0112171 43.2844439,77.0101681 43.2904876,77.0195695 43.292963,77.0184314 43.2972835,77.0212906 43.2991424,77.0288846 43.3043513,77.0309167 43.3052618,77.0327027 43.3062276,77.0407185 43.3101904,77.0261847 43.3194361,77.0258345 43.3195984,77.0260144 43.3197963,77.0260966 43.3199311,77.0261925 43.3202408,77.0267954 43.3209459,77.0268689 43.3209152,77.0273792 43.3216327,77.0275692 43.3215739,77.0278875 43.3219848,77.0277168 43.3221017,77.0280894 43.3225383,77.0282838 43.3224538,77.0283835 43.322679,77.0354756 43.3309366,77.0383158 43.3343464,77.039848 43.3363024,77.0396356 43.3364174,77.0411008 43.3378494,77.0407146 43.338145,77.0405501 43.3387033,77.0392819 43.3399349,77.0380121 43.3409053,77.0378887 43.3412237,77.0342298 43.344593,77.0338557 43.3448175,77.0336485 43.3451348,77.0318552 43.3467596,77.0327699 43.3472078,77.0338564 43.3472519,77.0342321 43.347985,77.0360701 43.3488952,77.0369994 43.3490037,77.0386136 43.3461579,77.0473588 43.3486816,77.044717 43.3531458,77.0517073 43.3565986,77.0572392 43.3595497,77.0601994 43.3596203,77.0649222 43.3619588,77.0747698 43.3694047,77.084902 43.3744051,77.0854594 43.3738149,77.0872934 43.3747601,77.0870453 43.3754599,77.0903173 43.3770807,77.100843 43.3822943,77.1010031 43.382115,77.1026501 43.3828669,77.1023319 43.3833427,77.1023802 43.3841146,77.1018636 43.3844837,77.0997736 43.383448,77.1004828 43.3826623,77.0867031 43.375845,77.0865971 43.375989,77.0855723 43.3761474,77.0839782 43.3753789,77.0845547 43.3747819,77.0775775 43.3713476,77.0760229 43.3729377,77.0730297 43.3715112,77.0692192 43.3730988,77.0690297 43.3731777,77.0678526 43.374439,77.0448403 43.36295,77.0222131 43.3624751,77.0115424 43.3597733,77.0113867 43.3606971,77.0115199 43.3612106,77.0120516 43.3611256,77.0127195 43.3637409,77.0128818 43.3690579,77.0119938 43.369762,77.0116152 43.370568,77.0120068 43.3712101,77.0120868 43.3730819,77.0124247 43.3737732,77.0132623 43.3749686,77.0122951 43.3750615,77.0121138 43.3752351,77.0120056 43.3755217,77.0121091 43.3759866,77.0119911 43.3765718,77.0116258 43.3770286,77.0112465 43.3772551,77.010973 43.3778734,77.0112029 43.3785259,77.0111836 43.3796588,77.0111678 43.3799967,77.0111611 43.3804072,77.0115819 43.3810533,77.0130245 43.3822469,77.0153723 43.3846003,77.0160983 43.3858071,77.0161111 43.3860658,77.0122016 43.3867162,77.008683 43.3872148,77.0082556 43.3875712,77.008372 43.3883153,77.0055771 43.3884262,77.0052393 43.3886565,77.006556 43.3901851,77.0070422 43.3904056,77.0075392 43.3913031,77.0074185 43.3921233,77.0046652 43.3927256,77.0048364 43.3932293,77.0047114 43.3932701,77.0041497 43.3923006,77.0032719 43.3927447,77.0026162 43.393224,77.0035418 43.3942644,77.0030247 43.3944338,77.0025871 43.3939294,77.0017489 43.3943391,77.0020287 43.3948331,77.0011479 43.3951103,77.0027312 43.3991009,77.0004044 43.3978773,76.9999796 43.3977413,76.9994438 43.3977036,76.9984798 43.3979726,76.9971359 43.3988615,76.9966369 43.3992586,76.9955219 43.3995331,76.994271 43.3996664,76.9931969 43.3995207,76.9923046 43.3991866,76.9889992 43.4012487,76.9882446 43.4018276,76.9880068 43.4018603,76.9875749 43.4028109,76.9873379 43.4036849,76.9871891 43.4035712,76.987129 43.403328,76.9868691 43.4030966,76.9867514 43.4030536,76.9866427 43.4030616,76.9865715 43.40309,76.9864661 43.4032858,76.9863562 43.4035693,76.986163 43.4037465,76.9860134 43.4037657,76.9858872 43.4036668,76.9858357 43.4035034,76.9858705 43.4033343,76.9860967 43.4032204,76.9862278 43.4031582,76.9862678 43.4030488,76.9862491 43.402934,76.9860819 43.4028229,76.9853952 43.4027543,76.9851807 43.4024612,76.9853609 43.4021307,76.9845541 43.4018875,76.9840134 43.4018438,76.9836185 43.4014322,76.9829147 43.4012265,76.9825277 43.4007278,76.9830711 43.4006873,76.9834293 43.4007829,76.9838632 43.4005621,76.9835413 43.4003409,76.9831978 43.4002004,76.9826744 43.4003222,76.982822 43.400006,76.9832963 43.3997451,76.9832214 43.39946,76.983095 43.3991061,76.9828718 43.3989502,76.982374 43.3990625,76.9819963 43.3990625,76.9817755 43.398926,76.9817451 43.3987908,76.9819355 43.3986789,76.9820034 43.3986546,76.9819786 43.3985723,76.9819023 43.3985184,76.981553 43.3984717,76.9812067 43.3984139,76.9810678 43.398259,76.9812153 43.398021,76.9813414 43.3979832,76.9817407 43.3980478,76.9818257 43.3979744,76.9819019 43.3976531,76.9819319 43.3973103,76.9818722 43.3971077,76.9816053 43.3970044,76.981445 43.3966025,76.9810868 43.3964045,76.9810176 43.3962793,76.9811278 43.3961771,76.9811018 43.3960431,76.9809908 43.3959828,76.9807475 43.3959375,76.980415 43.3958316,76.980383 43.3957467,76.980563 43.3956389,76.980783 43.3956101,76.9808981 43.3955574,76.9809972 43.3953986,76.9810408 43.3952799,76.9808205 43.3950524,76.9807524 43.3948847,76.9807055 43.394778,76.980563 43.3946969,76.980433 43.3946627,76.9801853 43.3944349,76.9799024 43.3938392,76.9798876 43.3935945,76.9799364 43.3934059,76.9800703 43.3930129,76.9800761 43.3928772,76.9800878 43.3927621,76.9803239 43.3925126,76.980622 43.3923388,76.980489 43.3921581,76.9802642 43.3921642,76.9802062 43.3920614,76.9803578 43.3919108,76.9803781 43.3917236,76.9802876 43.3916605,76.9802015 43.3915474,76.9801976 43.3914447,76.9801904 43.3914325,76.9800293 43.3911592,76.979999 43.3908197,76.9801619 43.3906356,76.9802341 43.3905432,76.9803129 43.3903828,76.9800509 43.390197,76.9800308 43.3901751,76.9800079 43.3901625,76.9798293 43.3900626,76.9797078 43.3900365,76.9790788 43.390062,76.9788226 43.3900603,76.9786414 43.3900098,76.9785674 43.3899114,76.9785368 43.3896651,76.9784768 43.3895806,76.9784723 43.3894883,76.9788069 43.3892628,76.9790438 43.3890461,76.9790867 43.3888964,76.9787434 43.3887654,76.9782799 43.3889276,76.9779056 43.3890163,76.9776758 43.3891027,76.9776048 43.3891562,76.9776017 43.3892353,76.9775282 43.3893539,76.9774192 43.389378,76.977314 43.3893335,76.9772499 43.3892457,76.9772392 43.3891571,76.9772082 43.3890248,76.9771898 43.3887717,76.9771207 43.3885385,76.9769551 43.3884728,76.976798 43.3884593,76.976714 43.3884196,76.9765945 43.388288,76.9762791 43.3881368,76.9761255 43.3880107,76.9759637 43.3878245,76.9758766 43.3875304,76.9758078 43.3874089,76.9756454 43.3873814,76.9755212 43.3874025,76.9754296 43.3872606,76.9753026 43.3871969,76.9751261 43.3871786,76.9750242 43.3872193,76.9749466 43.3873137,76.9749067 43.3875321,76.9749594 43.3877117,76.97488 43.3877737,76.97465 43.3877732,76.9743952 43.3877631,76.974049 43.3877158,76.9737652 43.3876053,76.9734133 43.3872871,76.9723868 43.3869782,76.9718263 43.3870364,76.9715941 43.3867862,76.9718683 43.3862891,76.9712418 43.3858961,76.9716537 43.3855531,76.9716366 43.3852474,76.971228 43.3851877,76.9710434 43.3850755,76.9709281 43.3850183,76.9709192 43.3849368,76.9710118 43.3848461,76.9712249 43.3848133,76.9713716 43.3847731,76.971439 43.3846666,76.9713922 43.3845749,76.9713071 43.3845519,76.97114 43.3845614,76.9710394 43.3845382,76.9707439 43.3843991,76.9704435 43.3842556,76.9703062 43.3839624,76.9696367 43.3837316,76.9685038 43.3837067,76.9683235 43.3840435,76.9679201 43.384293,76.9674824 43.3841496,76.9674051 43.3838002,76.9679201 43.3834946,76.9680059 43.3832388,76.9677399 43.3831078,76.966667 43.3833324,76.9665726 43.3831515,76.9672592 43.3825963,76.9663752 43.3826088,76.9660936 43.3825106,76.9661506 43.3822898,76.9665146 43.3820226,76.9666927 43.3819663,76.9669887 43.3817178,76.9668086 43.3815112,76.9665086 43.381487,76.9662225 43.3816311,76.9658351 43.3817265,76.9655948 43.381667,76.9654587 43.3815229,76.9653531 43.3811026,76.9654449 43.380964,76.9659352 43.3807432,76.9657059 43.3800992,76.9656823 43.3798972,76.9656042 43.3798474,76.9655147 43.3798689,76.9653956 43.379999,76.9648736 43.3806069,76.9646994 43.3806512,76.9643078 43.3807257,76.9641317 43.3807731,76.9640172 43.3807459,76.9639045 43.3805974,76.9638798 43.3804001,76.9641097 43.3802389,76.9643492 43.3801523,76.9644565 43.3799873,76.9643639 43.3798998,76.9642083 43.3799218,76.9638817 43.3800919,76.9635904 43.3799907,76.9635607 43.3798155,76.9630762 43.3793795,76.9615171 43.3801209,76.9606113 43.3792808,76.9601818 43.3794262,76.9612402 43.3805344,76.9577211 43.3817216,76.9573736 43.3811687,76.9559412 43.3788895,76.952132 43.3798477,76.9499968 43.3794655,76.9444056 43.3812174,76.9412854 43.3812533,76.9407847 43.3811284,76.9385463 43.3791059,76.9380328 43.3785729,76.9372841 43.3790826,76.937868 43.3801126,76.9377783 43.3801672,76.9365819 43.3802954,76.9363225 43.379213,76.9349279 43.3778305,76.934899 43.3777756,76.9348445 43.377672,76.9343166 43.3766685,76.9332081 43.3768835,76.9309482 43.3771416,76.9308559 43.3772931,76.9313767 43.37834,76.9315625 43.3794933,76.9291996 43.3798218,76.92713 43.3746627,76.9282691 43.3744475,76.9299229 43.3742131,76.9298628 43.3737153,76.9296606 43.3734562,76.9292259 43.3731537,76.9278875 43.3714401,76.9276182 43.3711744,76.9273513 43.370771,76.9271128 43.3707988,76.9263124 43.3702913,76.9253714 43.3699368,76.9249912 43.3696993,76.9246029 43.369362,76.9245339 43.369088,76.9245814 43.3686533,76.9244942 43.368163,76.9245863 43.3679707,76.9247746 43.367833,76.9243343 43.3669069,76.9240948 43.3668395,76.9239421 43.3668843,76.9238269 43.3669949,76.9234488 43.3669976,76.9231884 43.366908,76.9229562 43.3667585,76.9228475 43.3665058,76.9229096 43.3662649,76.9230106 43.3656058,76.9228684 43.3649873,76.9226212 43.3643657,76.9224336 43.3643919,76.9220621 43.3641969,76.9217442 43.3637453,76.9215575 43.3634802,76.9212887 43.3632991,76.9210438 43.36319,76.9206108 43.363186,76.9201197 43.3631229,76.91981 43.363042,76.919335 43.362799,76.9190305 43.36251,76.9190185 43.3623636,76.9190717 43.362256,76.9191739 43.3620494,76.9191945 43.3618339,76.9186402 43.3615118,76.9185692 43.3610474,76.9184879 43.3608736,76.9183019 43.3606691,76.9180362 43.3605565,76.9175847 43.360439,76.9171365 43.3598649,76.9171285 43.3596105,76.9172319 43.359272,76.9172102 43.3589685,76.9169417 43.358514,76.9168296 43.3576568,76.9165167 43.3575235,76.9150936 43.3573597,76.9142322 43.3568224,76.9138468 43.3565889,76.9131052 43.3562633,76.9127125 43.3552672,76.9124589 43.3550542,76.9117131 43.3550548,76.9095881 43.3520962,76.9094832 43.3521248,76.9089198 43.3519967,76.9090454 43.3513309,76.9088507 43.3512769,76.9077829 43.3516442,76.9072726 43.351704,76.9069171 43.3515478,76.9068104 43.3514483,76.9056358 43.3520242,76.9052459 43.351012,76.9043236 43.3498277,76.9012953 43.3477284,76.8925928 43.3435496,76.8917549 43.3408335,76.8908059 43.3396567,76.890381 43.3391298,76.8903913 43.3362034,76.8887839 43.3346344,76.8865694 43.335318,76.8855084 43.3344223,76.884827 43.3335792,76.8839941 43.3331091,76.8830673 43.3316321,76.8821614 43.3309732,76.8811913 43.3296123,76.8808155 43.3290077,76.8809252 43.3283352,76.880308 43.3278104,76.8763317 43.3295259,76.8763623 43.329696,76.8762707 43.3298883,76.8761996 43.3301324,76.8763216 43.3302656,76.8765555 43.3303691,76.8768402 43.3304135,76.8770334 43.3303987,76.8772571 43.3303691,76.8775011 43.3302434,76.877552 43.3300806,76.877552 43.3299105,76.877613 43.329696,76.8776943 43.3295703,76.8778875 43.3295629,76.8781316 43.3296368,76.8784061 43.3297478,76.8785586 43.3299031,76.8785688 43.330088,76.8784366 43.3302286,76.8783044 43.3303913,76.8781621 43.3305096,76.8779384 43.3306502,76.8778774 43.3307611,76.8779994 43.3309165,76.8780095 43.3311384,76.8778367 43.3312567,76.877552 43.3312789,76.8772774 43.331412,76.877074 43.3316487,76.8770029 43.3318188,76.87683 43.3321295,76.8767577 43.3323327,76.87683 43.3325881,76.8769825 43.3328026,76.8771045 43.3331798,76.8773588 43.3333203,76.8776536 43.3333647,76.8779994 43.3332167,76.8782027 43.3332315,76.8784366 43.3332981,76.8786705 43.3332981,76.8789044 43.333128,76.8788282 43.3329246,76.8788129 43.3328839,76.8788129 43.332773,76.8789247 43.332625,76.8791077 43.3324549,76.8793619 43.3322848,76.8795348 43.3322256,76.8796162 43.332344,76.8794941 43.3326472,76.8795043 43.3328321,76.8797178 43.3330392,76.879789 43.3331872,76.8796467 43.3333129,76.8793518 43.3334534,76.8787544 43.3338749,76.878457 43.3341857,76.8783146 43.3344445,76.8784265 43.3346294,76.8785944 43.3347726,76.8788317 43.3347909,76.8789432 43.3347465,76.8790474 43.3346602,76.879081 43.3346224,76.8791661 43.3345268,76.8793171 43.3345007,76.8794393 43.3345216,76.8794645 43.3346,76.8795687 43.3347151,76.8796802 43.3347779,76.8797736 43.3348223,76.8798671 43.3348589,76.8799714 43.334872,76.88009 43.334838,76.8801439 43.3347883,76.8801979 43.3347229,76.8802086 43.3346393,76.8801403 43.3345242,76.8800951 43.3344824,76.8800469 43.3344379,76.879957 43.3343856,76.8799534 43.3342967,76.8799462 43.3342026,76.8800145 43.3341503,76.88009 43.3341529,76.8802482 43.3342392,76.8804675 43.3344405,76.8806503 43.33458,76.8807156 43.3346994,76.8806796 43.3348825,76.8806005 43.335055,76.8805502 43.3351361,76.880356 43.3351335,76.8801583 43.3351492,76.8800037 43.3351152,76.8798491 43.3350603,76.8796262 43.3350158,76.8794681 43.3350263,76.879335 43.3350916,76.8792488 43.3351806,76.8792128 43.3352695,76.8791804 43.3353348,76.8791589 43.3354081,76.8791085 43.3354237,76.8789719 43.3353505,76.8787814 43.3353741,76.8786448 43.3353871,76.878501 43.3354316,76.8783823 43.3355153,76.8783104 43.3355859,76.8782925 43.3356931,76.8783032 43.335829,76.8783248 43.335931,76.8784003 43.3360225,76.878501 43.3360931,76.8787131 43.336169,76.8789072 43.3361977,76.8791517 43.3362213,76.8793314 43.3362187,76.8794788 43.336203,76.8796298 43.3361507,76.8797593 43.3361298,76.8800109 43.3361115,76.8802374 43.3361141,76.8804459 43.3361298,76.8805502 43.3361638,76.8806113 43.3362291,76.8806401 43.3363206,76.8806257 43.3364122,76.8806149 43.3365612,76.8806149 43.3367076,76.8806077 43.3368933,76.8805646 43.3370345,76.8804603 43.3371391,76.8802841 43.3372018,76.8802015 43.3372672,76.88009 43.3374346,76.8800391 43.3376211,76.8800751 43.3380499,76.880111 43.3383585,76.880147 43.3385676,76.8802189 43.3386984,76.8803051 43.3387611,76.8804418 43.3388187,76.8806287 43.3388239,76.8807581 43.338871,76.8807366 43.3389442,76.8805928 43.3390017,76.8804058 43.3391324,76.880298 43.3392789,76.8802261 43.3394305,76.8801757 43.3395351,76.8800894 43.3395979,76.8799672 43.3394985,76.8797875 43.339373,76.8796437 43.3392893,76.8794495 43.3393102,76.8792841 43.3393312,76.8791907 43.3394201,76.8791475 43.3395403,76.8789606 43.3395612,76.8787233 43.3395717,76.8784501 43.3395769,76.8782775 43.3396135,76.8781409 43.3397077,76.8781193 43.3398593,76.87822 43.340011,76.8784716 43.3400737,76.8786155 43.3400214,76.8786874 43.3400737,76.878637 43.3402097,76.8785076 43.34033,76.8783494 43.3404189,76.8782344 43.3405235,76.8781553 43.340649,76.8781402 43.3408307,76.8781377 43.3409787,76.8782852 43.3411821,76.8784428 43.3412376,76.8786461 43.3412413,76.8788546 43.3411414,76.878997 43.341012,76.8791393 43.3409454,76.8792359 43.3409824,76.8793071 43.3411155,76.8793543 43.341327,76.8793696 43.3414527,76.8793594 43.341534,76.8792831 43.3415988,76.8791891 43.3416505,76.8790671 43.3417041,76.8789883 43.3417522,76.8789171 43.3418188,76.8788764 43.3418779,76.8788612 43.34195,76.8788764 43.3420221,76.8789196 43.342085,76.8789781 43.3421331,76.8790544 43.3421497,76.8791332 43.3421515,76.8792298 43.3421478,76.8793594 43.3421183,76.8794738 43.3420831,76.8795704 43.3420757,76.8796568 43.3420905,76.8798119 43.3421589,76.8799136 43.3422421,76.8800076 43.3422773,76.8800204 43.3423457,76.8800051 43.3424122,76.8799238 43.3424658,76.8798602 43.3425028,76.8797916 43.3425158,76.8796975 43.3424529,76.8796212 43.3424159,76.8795602 43.3423716,76.8794763 43.3423327,76.8793543 43.3423179,76.8792628 43.3423272,76.8791001 43.3423586,76.8790366 43.3424141,76.8790264 43.3424825,76.8790467 43.3425916,76.8790925 43.3426895,76.879151 43.3427949,76.8792221 43.3428948,76.8792552 43.342965,76.8792831 43.3430297,76.8792882 43.3430889,76.879273 43.3431406,76.8792501 43.3431998,76.879212 43.3432497,76.8791789 43.3433144,76.8791484 43.3433662,76.8790925 43.3434364,76.8790137 43.3434827,76.8789362 43.3435305,76.8788544 43.3435313,76.8787681 43.3435496,76.8786998 43.3435653,76.8786207 43.3436019,76.8785524 43.3436438,76.8784949 43.3436856,76.8784266 43.3437588,76.8783726 43.3438059,76.8783151 43.3438477,76.8782396 43.3438712,76.8781641 43.3438921,76.8780958 43.3439131,76.8780239 43.3439366,76.8779664 43.3439863,76.8779165 43.3440194,76.8778546 43.3439684,76.8778113 43.3439286,76.8777758 43.3438972,76.8777402 43.3438676,76.8776931 43.3438436,76.8776398 43.3438214,76.8775787 43.34379,76.8775101 43.3437743,76.8774478 43.3437539,76.8773563 43.3437465,76.8772394 43.3437502,76.8771072 43.3437502,76.8769852 43.3437428,76.8769179 43.3437351,76.8768886 43.3437317,76.8767665 43.3437207,76.8766394 43.3437207,76.8765225 43.3437539,76.876492 43.3438427,76.8764818 43.343924,76.8765581 43.3439869,76.876614 43.3440349,76.8766903 43.3440756,76.8767564 43.3441237,76.8768012 43.344188,76.8768227 43.3442586,76.8768214 43.3443086,76.8767915 43.3443765,76.8767466 43.3444282,76.8766569 43.3444499,76.876556 43.3444499,76.8764364 43.3444472,76.8763056 43.3444825,76.8761973 43.3445287,76.8761225 43.3446021,76.8760216 43.3447027,76.8759618 43.3448032,76.8758983 43.3449038,76.875831 43.3450152,76.8757376 43.3450696,76.8756442 43.3450804,76.8755171 43.3450641,76.8752958 43.3450584,76.8751613 43.3451182,76.875094 43.3452106,76.8750566 43.3453139,76.8750865 43.3454552,76.8751837 43.3455694,76.8754079 43.3456129,76.8756172 43.3456346,76.8757966 43.3456346,76.8759386 43.3457162,76.8760283 43.3457868,76.8760432 43.3458629,76.8759535 43.3459553,76.8757517 43.3460097,76.8754378 43.3460586,76.8752808 43.3462271,76.8752862 43.3463597,76.8752883 43.3464119,76.875197 43.3465285,76.8744056 43.3464815,76.8736872 43.3464723,76.8732345 43.3465757,76.8731319 43.3470277,76.8721909 43.3472368,76.8657904 43.3468975,76.8626306 43.3364176,76.8601677 43.3364791,76.8596603 43.3350952,76.8590155 43.3335728,76.8576731 43.3332115,76.8571446 43.3332345,76.8557463 43.3342973,76.854072 43.3345365,76.8519343 43.3349497,76.8517251 43.3353955,76.8513065 43.3361675,76.8510374 43.3365154,76.8512317 43.3368742,76.8518446 43.3374722,76.8526519 43.3383855,76.8531302 43.3393532,76.8531543 43.3402116,76.8537731 43.3406361,76.8542963 43.3413645,76.8549839 43.3419842,76.8558659 43.3427561,76.855821 43.3429736,76.8555819 43.3435498,76.8554324 43.3437454,76.8542215 43.3444195,76.8537145 43.3446102,76.851792 43.3447478,76.8518003 43.3465223,76.8510427 43.3474402,76.8501228 43.3475037,76.8490268 43.3485955,76.848714 43.35016,76.847647 43.3514755,76.847761 43.3519569,76.8490947 43.3519024,76.8493027 43.3535062,76.8505272 43.3541014,76.8427995 43.3546881,76.8398382 43.3540675,76.8373525 43.3540894,76.8350657 43.3540735,76.8301335 43.3529599,76.8246053 43.3528655,76.8189073 43.3541241,76.8133889 43.3546993,76.8112864 43.3508746,76.8065164 43.3456678,76.803821 43.3378305,76.801831 43.333383,76.8010148 43.3293718,76.7968426 43.3294353,76.7908199 43.3293566,76.7872389 43.325856,76.7868674 43.3255335,76.7867112 43.3254532,76.784809 43.3254272,76.7846621 43.3253785,76.7843711 43.3251668,76.7841964 43.3249127,76.7842047 43.3248038,76.7847785 43.3241021,76.7847702 43.3239871,76.7847286 43.3238843,76.7843627 43.3234185,76.7842131 43.3233398,76.7840135 43.3232733,76.7836642 43.3232067,76.7834896 43.3231402,76.7833815 43.3229708,76.7832401 43.3225473,76.7832318 43.3223174,76.7830156 43.3216398,76.7828908 43.3214099,76.7824251 43.3208231,76.7823836 43.320696,76.7822838 43.3201334,76.7826597 43.3199019,76.7734932 43.3186465,76.7714802 43.3181553,76.7719976 43.3171591,76.7723961 43.3167519,76.760307'
    # geometryText = 'LINESTRING(73.7616152 43.6095671,73.762623 43.6091083,73.7650157 43.6079999)'
    # geometryText = 'MULTILINESTRING((28.9123208 55.9500483,28.9105406 55.9506687,28.9098366 55.9507624,28.9085689 55.9509324,28.9078261 55.9510927,28.9073375 55.9508704,28.906914 55.9508586,28.9054046 55.950354,28.9042354 55.9504794,28.9036882 55.9502091,28.9045694 55.9493952,28.9038811 55.9487196,28.9037978 55.9469333,28.89962 55.94616,28.8984703 55.9464347,28.8969509 55.9469952,28.8947283 55.9462698,28.8948744 55.9457755,28.8937426 55.9453008,28.8923532 55.9458836,28.8916945 55.9456157,28.8916785 55.9456968,28.8915765 55.9459462,28.89148 55.9460122,28.8916087 55.9467812,28.8907504 55.9468533,28.8903856 55.9464748,28.8901711 55.9468233,28.8897741 55.9469795,28.8893771 55.9466491,28.8890016 55.9468113,28.8890016 55.9470996,28.8886798 55.9471116,28.8885617 55.9467031,28.8882399 55.9468293,28.8880682 55.9469795,28.8875103 55.9470696,28.886888 55.9474781,28.8868666 55.9478206,28.8866627 55.9482651,28.885783 55.9483192,28.8859117 55.9486316,28.8849247 55.9486796,28.8851285 55.9492383,28.8836909 55.9493525,28.8835621 55.9498691,28.8828755 55.9499472,28.8824785 55.9496889,28.8822103 55.9498751,28.8810408 55.9500974,28.8806117 55.9504818,28.8798285 55.9505299,28.8797748 55.9501454,28.8791847 55.9503557,28.878777 55.9504578,28.8783801 55.9500073,28.8771999 55.9501454,28.87676 55.9504398,28.8764167 55.9501334,28.8756871 55.9502355,28.8750863 55.9507521,28.8744104 55.9507101,28.8740349 55.9507521,28.8735092 55.9510825,28.8738418 55.9514129,28.8731873 55.9513168,28.8730693 55.9516232,28.8726402 55.951479,28.8720072 55.9517433,28.8714493 55.9515691,28.8710523 55.9517373,28.870827 55.9521458,28.8698185 55.9520977,28.869679 55.9518394,28.8688851 55.9522058,28.8684023 55.9521398,28.8685417 55.95232,28.8677263 55.952302,28.8669968 55.9525963,28.8664818 55.95235,28.8659239 55.9526624,28.8647115 55.952374,28.864497 55.9525062,28.8642633 55.9526302,28.8637781 55.9525663,28.8634348 55.952362,28.8627911 55.9525602,28.862437 55.9524461,28.8613963 55.9525783,28.8609243 55.9521398,28.8602483 55.9522419,28.8600016 55.9520437,28.8597655 55.9520256,28.8593257 55.952338,28.8590253 55.952326,28.8577271 55.9520557,28.857373 55.9524281,28.8569331 55.952356,28.8564503 55.9524882,28.8561177 55.9524641,28.8559032 55.9526443,28.8560319 55.9530048,28.855753 55.9530288,28.855474 55.9527585,28.8552058 55.9527705,28.8550234 55.9530708,28.8542938 55.9529327,28.8539612 55.953203,28.8539398 55.9536775,28.8536608 55.9538337,28.8525558 55.9537075,28.8518262 55.9538337,28.8513434 55.9536655,28.8503349 55.954092,28.8500023 55.9544343,28.8495302 55.9543502,28.8492084 55.9544764,28.8491118 55.9547347,28.8489187 55.9549089,28.8484037 55.9546446,28.8479424 55.9547827,28.8478565 55.9549809,28.8475561 55.9547106,28.8473523 55.9546506,28.8471377 55.9546806,28.8472235 55.9545124,28.8475132 55.9544163,28.8477278 55.9541821,28.8476742 55.9540559,28.8472557 55.9538577,28.8467622 55.9539838,28.8464833 55.9543262,28.8455177 55.9540619,28.8450563 55.9544824,28.8452387 55.9546686,28.8449276 55.9548488,28.8440371 55.9548728,28.8440585 55.9545124,28.8439623 55.9543469,28.8431681 55.9543519,28.8411708 55.955459,28.8374 55.95611,28.8368788 55.9574909,28.8358628 55.9591913,28.83336 55.95929,28.8307 55.96006,28.8285754 55.9613656,28.8272406 55.9635926,28.82092 55.96444,28.8138903 55.9662579))'
    geometryText = str(sheet[row][8].value)

    if geometryText != 'None' or pointText != 'None':
        multyGeometryKML = KML.MultiGeometry()
    else:
        print 'No point or geometry in the input file in line: ' + str(row)
        sys.exit(1)

    # преобразуем к нужному формату, если не пусто
    if pointText != 'None':
        point = shapely.wkt.loads(pointText)
        pointCoords = cleanPointCoords(point)
        pointKML = KML.Point(KML.coordinates(pointCoords))
        # добавляем точку в мультигеометрию, которая будет помещена в placemark
        multyGeometryKML.append(pointKML)

    geometryType = ''
    # преобразуем к типу геометрии, если не пусто
    if geometryText != 'None':
        try:
            geometry = shapely.wkt.loads(geometryText)
            geometryType = geometry.geom_type  # mapping(shapely.wkt.loads(geometryText))['type']
        except Exception as e:
            print e
            print 'Geometry must have a geotext format in the input file. Your format is: ' + geometryText + ' in line: ' + str(
                row)
            sys.exit(1)
        if geometryType == 'MultiPolygon':
            # listGeometry = list(geometry)
            kml_multiGeomPolygons = multiGeometryToArrayPolygonsKML(list(geometry))
            # multyGeometryKML = KML.MultiGeometry()
            for kml_poly in kml_multiGeomPolygons:
                multyGeometryKML.append(kml_poly)
        elif geometryType == 'Polygon':
            # geometryArray = []
            geometryArray = [geometry]
            kml_multiGeomPolygons = multiGeometryToArrayPolygonsKML(geometryArray)
            for kml_poly in kml_multiGeomPolygons:
                multyGeometryKML.append(kml_poly)
        elif geometryType == 'MultiLineString':
            kml_multiLineStrings = multiGeometryToArrayLineStringsKML(geometry)
            for kml_line in kml_multiLineStrings:
                multyGeometryKML.append(kml_line)
        elif geometryType == 'LineString':
            lineStringArray = [geometry]
            kml_multiLineStrings = multiGeometryToArrayLineStringsKML(lineStringArray)
            for kml_line in kml_multiLineStrings:
                multyGeometryKML.append(kml_line)
        else:
            print geometryType + ' is not supported'
    # прозрачность цвета для полигонов
    colorFill = '4D'
    # генерируем цвет элемента
    color = colorFill + generateRandomColor()
    placeMarkMulti = KML.Placemark(
        KML.description(sheet[row][0].value),
        KML.name(sheet[row][6].value),
        KML.Style(KML.LineStyle(
            KML.color(color)
        ),
            KML.PolyStyle(
                KML.color(color),
                KML.fill("1"),
                KML.outline("1")
            )))
    placeMarkMulti.append(multyGeometryKML)
    doc.Document.append(placeMarkMulti)

print(etree.tostring(doc, pretty_print=True))

my_file = open(outputFilePath, "w+")
my_file.write(etree.tostring(doc, pretty_print=True))
my_file.close()
